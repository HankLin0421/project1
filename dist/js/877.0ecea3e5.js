"use strict";(self["webpackChunkproject"]=self["webpackChunkproject"]||[]).push([[877],{2258:function(e,t,l){l.r(t),l.d(t,{default:function(){return W}});l(4114);var a=l(6768),o=l(5130),n=l(4232),s=l(9325),c=l(4373),d=l(144);const u=e=>((0,a.Qi)("data-v-0f24dbb7"),e=e(),(0,a.jt)(),e),r={class:"container-fluid"},p={class:"row justify-content-md-center"},i={class:"col-lg-8 col-md-10 col-sm-12 col-12 border"},k=u((()=>(0,a.Lk)("h3",{class:"p-2 mb-3 bg-secondary bg-opacity-50 text-dark"},"基本資料",-1))),m={class:"p-4"},v={class:"mb-5"},h=u((()=>(0,a.Lk)("label",{for:"name",class:"me-2"},"訂購人姓名 :",-1))),b={class:"mb-5"},L=u((()=>(0,a.Lk)("label",{for:"phone",class:"me-2"},"連絡電話 :",-1))),_={class:"mb-5"},y=u((()=>(0,a.Lk)("label",{for:"note",class:"me-2"},"備註 :",-1))),x=u((()=>(0,a.Lk)("h3",{class:"p-2 mb-3 bg-secondary bg-opacity-50 text-dark"},"商品確認",-1))),f={class:"table-responsive text-center py-3"},C={class:"table table-hover align-middle"},g=u((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{scope:"col",width:"20%"},"順序"),(0,a.Lk)("th",{scope:"col",width:"20%"},"名稱"),(0,a.Lk)("th",{scope:"col",width:"20%"},"價格"),(0,a.Lk)("th",{scope:"col",width:"20%"},"數量"),(0,a.Lk)("th",{scope:"col",width:"20%"},"小計")])],-1))),w=["textContent"],I=["textContent"],A=["textContent"],j=["textContent"],E=["textContent"],S=u((()=>(0,a.Lk)("h3",{class:"p-2 mb-3 bg-secondary bg-opacity-50 text-dark"},"運送方式",-1))),U={class:"p-4"},V=u((()=>(0,a.Lk)("label",{for:"store"},"店內自取",-1))),X={class:"p-4"},q={class:"mb-5"},J=u((()=>(0,a.Lk)("label",{for:"express"},"國內運送",-1))),K={key:0,class:"mb-5 ms-1"},R=u((()=>(0,a.Lk)("label",{for:"address",class:"me-2"},"配送地址 :",-1))),T=u((()=>(0,a.Lk)("h3",{class:"p-2 mb-3 bg-secondary bg-opacity-50 text-dark"},"金額總額",-1))),N={class:"p-4 text-center"},Q=["textContent"],$=["textContent"];var z={__name:"h_checkout",setup(e){const t="http://localhost/project/select.php",l="http://localhost/project/login.php",u=(0,d.KR)(""),z=(0,d.KR)({}),F=(0,d.KR)([]),O=(0,d.KR)("120"),W=(0,a.EW)((()=>{let e=0;return F.value.forEach((t=>{e+=t.p_price*t.qty})),e+=Number(O.value),e}));function B(){let e={headers:{"Content-Type":"application/x-www-form-urlencoded"}},t={do:"orderInfo",m_account:localStorage.getItem("userAcc")};c.A.post(l,t,e).then((e=>{z.value=e.data}))}async function D(){let e=localStorage.getItem("cartlist"),l=JSON.parse(e);for(let a of l)await c.A.get(t,{params:{do:"cart",p_id:a.p_id,qty:a.qty}}).then((e=>{F.value.push(e.data)}))}const G=()=>{let e={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}},t={o_account:z.value.m_account,o_name:z.value.m_name,o_address:z.value.m_address,o_phone:z.value.m_phone,o_note:u.value,o_total:W.value,o_delivery:"",o_deliveryStatus:"準備中"};"120"==O.value?t.o_delivery="國內運送":(t.o_delivery="店內自取",t.o_address=""),console.log(t);const a={do:"checkout",orderInfo:t,cartInfo:localStorage.getItem("cartlist")};c.A.post(l,a,e).then((e=>{console.log(e.data),e.data?(localStorage.setItem("cartlist","[]"),s.A.push({name:"order"})):(alert("下單失敗"),s.A.push({name:"cartlist"}))}))};return B(),D(),window.scrollTo(0,0),(e,t)=>((0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",p,[(0,a.Lk)("div",i,[k,(0,a.Lk)("div",m,[(0,a.Lk)("h5",v,[h,(0,a.bo)((0,a.Lk)("input",{id:"name",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>z.value.m_name=e)},null,512),[[o.Jo,z.value.m_name]])]),(0,a.Lk)("h5",b,[L,(0,a.bo)((0,a.Lk)("input",{id:"phone",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>z.value.m_phone=e)},null,512),[[o.Jo,z.value.m_phone]])]),(0,a.Lk)("h5",_,[y,(0,a.bo)((0,a.Lk)("input",{id:"note",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>u.value=e)},null,512),[[o.Jo,u.value]])])]),x,(0,a.Lk)("div",f,[(0,a.Lk)("table",C,[g,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(F.value,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.p_id},[(0,a.Lk)("th",{scope:"row",textContent:(0,n.v_)(t+1)},null,8,w),(0,a.Lk)("td",{textContent:(0,n.v_)(e.p_name)},null,8,I),(0,a.Lk)("td",{textContent:(0,n.v_)(e.p_price)},null,8,A),(0,a.Lk)("td",{textContent:(0,n.v_)(e.qty)},null,8,j),(0,a.Lk)("td",{textContent:(0,n.v_)(e.p_price*e.qty)},null,8,E)])))),128))])])]),S,(0,a.Lk)("div",U,[(0,a.Lk)("h5",null,[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"store","onUpdate:modelValue":t[3]||(t[3]=e=>O.value=e),value:"0"},null,512),[[o.XL,O.value]]),V])]),(0,a.Lk)("div",X,[(0,a.Lk)("h5",q,[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"express",value:"120","onUpdate:modelValue":t[4]||(t[4]=e=>O.value=e)},null,512),[[o.XL,O.value]]),J]),"120"===O.value?((0,a.uX)(),(0,a.CE)("h5",K,[R,(0,a.bo)((0,a.Lk)("input",{id:"address",type:"text",size:"30","onUpdate:modelValue":t[5]||(t[5]=e=>z.value.m_address=e)},null,512),[[o.Jo,z.value.m_address]])])):(0,a.Q3)("",!0)]),T,(0,a.Lk)("div",N,[(0,a.Lk)("h4",{class:"mb-5",textContent:(0,n.v_)(`運費 :${O.value}`)},null,8,Q),(0,a.Lk)("h4",{class:"mb-5",textContent:(0,n.v_)(`總額 :${W.value}`)},null,8,$),(0,a.Lk)("button",{type:"button",class:"btn btn-success fs-5",onClick:G}," 下單 ")])])])]))}},F=l(1241);const O=(0,F.A)(z,[["__scopeId","data-v-0f24dbb7"]]);var W=O}}]);
//# sourceMappingURL=877.0ecea3e5.js.map