{"version":3,"file":"js/877.0ecea3e5.js","mappings":"+0DA2FA,MAAMA,EAAYC,sCACZC,EAAYD,qCACZE,GAAOC,EAAAA,EAAAA,IAAI,IACXC,GAAYD,EAAAA,EAAAA,IAAI,CAAC,GACjBE,GAAWF,EAAAA,EAAAA,IAAI,IACfG,GAAiBH,EAAAA,EAAAA,IAAI,OACrBI,GAAWC,EAAAA,EAAAA,KAAS,KACxB,IAAIC,EAAQ,EAKZ,OAJAJ,EAASK,MAAMC,SAASC,IACtBH,GAASG,EAAKC,QAAUD,EAAKE,GAAG,IAElCL,GAASM,OAAOT,EAAeI,OACxBD,CAAK,IAEd,SAASO,IACP,IAAIC,EAAS,CACXC,QAAS,CACP,eAAgB,sCAGhBC,EAAO,CACTC,GAAI,YACJC,UAAWC,aAAaC,QAAQ,YAElCC,EAAAA,EAAMC,KAAKxB,EAAWkB,EAAMF,GAAQS,MAAMC,IACxCvB,EAAUM,MAAQiB,EAAIR,IAAI,GAE9B,CACAS,eAAeC,IACb,IAAIC,EAAWR,aAAaC,QAAQ,YAChCQ,EAAgBC,KAAKC,MAAMH,GAC/B,IAAK,IAAIlB,KAAQmB,QACTP,EAAAA,EACHU,IAAInC,EAAW,CACdoC,OAAQ,CACNf,GAAI,OACJgB,KAAMxB,EAAKwB,KACXtB,IAAKF,EAAKE,OAGbY,MAAMC,IACLtB,EAASK,MAAM2B,KAAKV,EAAIR,KAAK,GAGrC,CACA,MAAMmB,EAAQA,KACZ,IAAIrB,EAAS,CACXC,QAAS,CACP,eAAgB,oDAGhBqB,EAAa,CACfC,UAAWpC,EAAUM,MAAMW,UAC3BoB,OAAQrC,EAAUM,MAAMgC,OACxBC,UAAWvC,EAAUM,MAAMkC,UAC3BC,QAASzC,EAAUM,MAAMoC,QACzBC,OAAQ7C,EAAKQ,MACbsC,QAASzC,EAASG,MAClBuC,WAAY,GACZC,iBAAkB,OAEQ,OAAxB5C,EAAeI,MACjB6B,EAAWU,WAAa,QAExBV,EAAWU,WAAa,OACxBV,EAAWI,UAAY,IAEzBQ,QAAQC,IAAIb,GACZ,MAAMpB,EAAO,CACXC,GAAI,WACJhB,UAAWmC,EACXc,SAAU/B,aAAaC,QAAQ,aAEjCC,EAAAA,EAAMC,KAAKxB,EAAWkB,EAAMF,GAAQS,MAAMC,IACxCwB,QAAQC,IAAIzB,EAAIR,MACZQ,EAAIR,MACNG,aAAagC,QAAQ,WAAY,MACjCC,EAAAA,EAAOlB,KAAK,CAAEmB,KAAM,YAEpBC,MAAM,QACNF,EAAAA,EAAOlB,KAAK,CAAEmB,KAAM,aACtB,GACA,E,OAEJxC,IACAa,IACA6B,OAAOC,SAAS,EAAG,G,03DC3KnB,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://project/./src/views/h_checkout.vue","webpack://project/./src/views/h_checkout.vue?a02d"],"sourcesContent":["<template>\n  <div class=\"container-fluid\">\n    <div class=\"row justify-content-md-center\">\n      <div class=\"col-lg-8 col-md-10 col-sm-12 col-12 border\">\n        <h3 class=\"p-2 mb-3 bg-secondary bg-opacity-50 text-dark\">基本資料</h3>\n        <div class=\"p-4\">\n          <h5 class=\"mb-5\">\n            <label for=\"name\" class=\"me-2\">訂購人姓名 :</label>\n            <input id=\"name\" type=\"text\" v-model=\"orderInfo.m_name\" />\n          </h5>\n          <h5 class=\"mb-5\">\n            <label for=\"phone\" class=\"me-2\">連絡電話 :</label>\n            <input id=\"phone\" type=\"text\" v-model=\"orderInfo.m_phone\" />\n          </h5>\n          <h5 class=\"mb-5\">\n            <label for=\"note\" class=\"me-2\">備註 :</label>\n            <input id=\"note\" type=\"text\" v-model=\"note\" />\n          </h5>\n        </div>\n        <h3 class=\"p-2 mb-3 bg-secondary bg-opacity-50 text-dark\">商品確認</h3>\n        <div class=\"table-responsive text-center py-3\">\n          <table class=\"table table-hover align-middle\">\n            <thead>\n              <tr>\n                <th scope=\"col\" width=\"20%\">順序</th>\n                <th scope=\"col\" width=\"20%\">名稱</th>\n                <th scope=\"col\" width=\"20%\">價格</th>\n                <th scope=\"col\" width=\"20%\">數量</th>\n                <th scope=\"col\" width=\"20%\">小計</th>\n              </tr>\n            </thead>\n            <tbody>\n              <template\n                v-for=\"(product, index) in cartlist\"\n                :key=\"product.p_id\"\n              >\n                <tr>\n                  <th scope=\"row\" v-text=\"index + 1\"></th>\n                  <td v-text=\"product.p_name\"></td>\n                  <td v-text=\"product.p_price\"></td>\n                  <td v-text=\"product.qty\"></td>\n                  <td v-text=\"product.p_price * product.qty\"></td>\n                </tr>\n              </template>\n            </tbody>\n          </table>\n        </div>\n        <h3 class=\"p-2 mb-3 bg-secondary bg-opacity-50 text-dark\">運送方式</h3>\n        <div class=\"p-4\">\n          <h5>\n            <input type=\"radio\" id=\"store\" v-model=\"deliveryMethod\" value=\"0\" />\n            <label for=\"store\">店內自取</label>\n          </h5>\n        </div>\n        <div class=\"p-4\">\n          <h5 class=\"mb-5\">\n            <input\n              type=\"radio\"\n              id=\"express\"\n              value=\"120\"\n              v-model=\"deliveryMethod\"\n            />\n            <label for=\"express\">國內運送</label>\n          </h5>\n          <h5 v-if=\"deliveryMethod === '120'\" class=\"mb-5 ms-1\">\n            <label for=\"address\" class=\"me-2\">配送地址 :</label>\n            <input\n              id=\"address\"\n              type=\"text\"\n              size=\"30\"\n              v-model=\"orderInfo.m_address\"\n            />\n          </h5>\n        </div>\n        <h3 class=\"p-2 mb-3 bg-secondary bg-opacity-50 text-dark\">金額總額</h3>\n        <div class=\"p-4 text-center\">\n          <h4 class=\"mb-5\" v-text=\"`運費 :${deliveryMethod}`\"></h4>\n          <h4 class=\"mb-5\" v-text=\"`總額 :${alltotal}`\"></h4>\n          <button type=\"button\" class=\"btn btn-success fs-5\" @click=\"order\">\n            下單\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport router from \"@/router\";\nimport axios from \"axios\";\nimport { ref, computed } from \"vue\";\nconst selecturl = process.env.VUE_APP_API_URL;\nconst memberurl = process.env.VUE_APP_API_LOGIN;\nconst note = ref(\"\");\nconst orderInfo = ref({});\nconst cartlist = ref([]);\nconst deliveryMethod = ref(\"120\");\nconst alltotal = computed(() => {\n  let total = 0;\n  cartlist.value.forEach((item) => {\n    total += item.p_price * item.qty;\n  });\n  total += Number(deliveryMethod.value);\n  return total;\n});\nfunction getMember() {\n  let config = {\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n  };\n  let data = {\n    do: \"orderInfo\",\n    m_account: localStorage.getItem(\"userAcc\"),\n  };\n  axios.post(memberurl, data, config).then((res) => {\n    orderInfo.value = res.data;\n  });\n}\nasync function getCart() {\n  let CartList = localStorage.getItem(\"cartlist\");\n  let CartListArray = JSON.parse(CartList);\n  for (let item of CartListArray) {\n    await axios\n      .get(selecturl, {\n        params: {\n          do: \"cart\",\n          p_id: item.p_id,\n          qty: item.qty,\n        },\n      })\n      .then((res) => {\n        cartlist.value.push(res.data);\n      });\n  }\n}\nconst order = () => {\n  let config = {\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded;charset=utf-8\",\n    },\n  };\n  let memberInfo = {\n    o_account: orderInfo.value.m_account,\n    o_name: orderInfo.value.m_name,\n    o_address: orderInfo.value.m_address,\n    o_phone: orderInfo.value.m_phone,\n    o_note: note.value,\n    o_total: alltotal.value,\n    o_delivery: \"\",\n    o_deliveryStatus: \"準備中\",\n  };\n  if (deliveryMethod.value == \"120\") {\n    memberInfo.o_delivery = \"國內運送\";\n  } else {\n    memberInfo.o_delivery = \"店內自取\";\n    memberInfo.o_address = \"\";\n  }\n  console.log(memberInfo);\n  const data = {\n    do: \"checkout\",\n    orderInfo: memberInfo,\n    cartInfo: localStorage.getItem(\"cartlist\"),\n  };\n  axios.post(memberurl, data, config).then((res) => {\n    console.log(res.data);\n    if (res.data) {\n      localStorage.setItem(\"cartlist\", \"[]\");\n      router.push({ name: \"order\" });\n    } else {\n      alert(\"下單失敗\");\n      router.push({ name: \"cartlist\" });\n    }\n  });\n};\ngetMember();\ngetCart();\nwindow.scrollTo(0, 0);\n</script>\n<style scoped>\ninput:focus {\n  outline-color: rgb(0, 162, 255);\n}\n</style>\n","import script from \"./h_checkout.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./h_checkout.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./h_checkout.vue?vue&type=style&index=0&id=0f24dbb7&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0f24dbb7\"]])\n\nexport default __exports__"],"names":["selecturl","process","memberurl","note","ref","orderInfo","cartlist","deliveryMethod","alltotal","computed","total","value","forEach","item","p_price","qty","Number","getMember","config","headers","data","do","m_account","localStorage","getItem","axios","post","then","res","async","getCart","CartList","CartListArray","JSON","parse","get","params","p_id","push","order","memberInfo","o_account","o_name","m_name","o_address","m_address","o_phone","m_phone","o_note","o_total","o_delivery","o_deliveryStatus","console","log","cartInfo","setItem","router","name","alert","window","scrollTo","__exports__"],"sourceRoot":""}